---
title: "Neuroblastoma Data-Frame from R2 Database: Plots"
author: "Gepoliano Chaves"
date: "June 30th, 2023"
output:
  html_document:
    df_print: paged
    toc: yes
    number_sections: no
    toc_depth: 5
    toc_float: yes
header-includes:
- \usepackage{pdfpages}
 # output: slidy_presentation
bibliography: references.bib
---

# References

The survival analysis reference used was writen by Zabor 

* [@Zabor].

Transfer libraries

The survival analysis reference used was Jaeger.

* [@Jaeger].

To add p-values to plots, I used the Kassambara 2017 and 2020 references

* [@Kassambara2017]


# Load libraries

```{r}
library(maditr)
```

# 1) Continued processing of the R2 dataset

Load the GSVA object back to the R environment. This object now contains all the metadata information.

```{r}
r2_gse62564_GSVA_Metadata <- readRDS( "../results/r2_gse62564_GSVA_Metadata.rds")
```

In neuroblastoma, the main risk classification system classifies patients using features such as age, stage, histology and MYCN amplification status. 

MYCN is a gene that encodes a transcription factor that is very important in tumor prognosis, the association between tumor features and patient survival.

Let's take a look at the MYCN expression compared by the neuroblastoma risk group.

First, let's see which type of variable is the the MYCN status and the MYCN expression

```{r}
class(r2_gse62564_GSVA_Metadata$mycn_status)
class(r2_gse62564_GSVA_Metadata$MYCN)
```

They are both of type "character". In order to plot, we have to make the MYCN expression to be of type numeric

```{r}
r2_gse62564_GSVA_Metadata$MYCN <- as.numeric(r2_gse62564_GSVA_Metadata$MYCN)
class(r2_gse62564_GSVA_Metadata$MYCN)
```

# Check the age at diagnosis

```{r}
r2_gse62564_GSVA_Metadata$age_at_diagnosis <- as.numeric(r2_gse62564_GSVA_Metadata$age_at_diagnosis)
age_diagnosis_days_gse62564_498 <- mean(r2_gse62564_GSVA_Metadata$age_at_diagnosis)
```

# 2) First Plots of the Neuroblastoma R2 Dataset

## 2.1) MYCN Amplification status and MYCN expression

Let's try and see the boxplot of the MYCN expression vs. MYCN amplification status.

Using the boxplot function that we tried before, we will have an error.

```{r, eval=F}
boxplot(data=r2_gse62564_GSVA_Metadata, r2_gse62564_GSVA_Metadata$mycn_status, r2_gse62564_GSVA_Metadata$MYCN)
```

Maybe we could try the boxplot function making the mycn_status a numeric variable.

```{r, eval=F}
boxplot(data=r2_gse62564_GSVA_Metadata, as.numeric(r2_gse62564_GSVA_Metadata$mycn_status), r2_gse62564_GSVA_Metadata$MYCN)
```

Let's try and see if ggplot, which we have also used before, takes the mycn_status variable as categorical as it is right now.

```{r}
library(ggplot2)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=mycn_status, y=MYCN, fill=mycn_status)) + 
    geom_boxplot()
```

In this figure, we see that group with clinical MYCN amplification, also shows high MYCN expression

What is the difference, in measurement, between MYCN amplification and MYCN expression?

How are the MYCN amplification and MYCN gene expression correlated?

For now, I am not bothering neither with formating of the X and Y labels nor with the N/A values of the MYCN amplification status.

## 2.2) High Risk status and MYCN expression

We can plot the high risk status vs. MYCN amplification and leave the fill argument as mycn_status

```{r}
library(ggplot2)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=MYCN, fill=mycn_status)) + 
    geom_boxplot()
```

Or we can make it the high_risk status instead

```{r}
library(ggplot2)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=MYCN, fill=high_risk)) + 
    geom_boxplot()
```

Here we see that the high_risk status correlates positively with MYCN expression.

# 3) Survival Analysis

Make the OS (overall survival) status numeric, instead of character. Do the same for the EFS.

```{r}
## OS
r2_gse62564_GSVA_Metadata <- r2_gse62564_GSVA_Metadata %>%
  dplyr::mutate(os_bin_numeric =
                  ifelse(r2_gse62564_GSVA_Metadata$os_bin == "event", "1", "0"))

r2_gse62564_GSVA_Metadata["os_bin_numeric"] <- as.numeric(r2_gse62564_GSVA_Metadata$os_bin_numeric)

## EFS
r2_gse62564_GSVA_Metadata <- r2_gse62564_GSVA_Metadata %>%
  dplyr::mutate(efs_bin_numeric =
                  ifelse(r2_gse62564_GSVA_Metadata$efs_bin == "event", "1", "0"))

r2_gse62564_GSVA_Metadata["efs_bin_numeric"] <- as.numeric(r2_gse62564_GSVA_Metadata$efs_bin_numeric)
```

## 3.1) Survival Plots

```{r}
library(survival)
fit_os_high_risk <- survfit(Surv(as.numeric(os_day), os_bin_numeric) ~ r2_gse62564_GSVA_Metadata$high_risk,
                   data = r2_gse62564_GSVA_Metadata)
library(survminer)
ggsurvplot(fit_os_high_risk, 
           data = r2_gse62564_GSVA_Metadata, 
           risk.table = TRUE,
           # risk.table = "abs_pct",
           pval = TRUE, 
           pval.coord = c(2000, 1),
           )

ggsurvplot(fit_os_high_risk, 
           data = r2_gse62564_GSVA_Metadata, 
           # risk.table = TRUE,
           risk.table = "abs_pct",
           pval = TRUE, 
           pval.coord = c(2000, 1),
           )
```

* Have students generate the EFS plot

# 4) The Hypoxia Effect "Controversy"

Let's now establish a relationship between neuroblastoma high risk status and hypoxia, one of the novelties of our work.

## 4.1) HIF1A

```{r}
r2_gse62564_GSVA_Metadata$HIF1A <- as.numeric(r2_gse62564_GSVA_Metadata$HIF1A)

compare_means(data = r2_gse62564_GSVA_Metadata, HIF1A ~ high_risk, method = "t.test")

ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=HIF1A, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test", label.x = 1.4)+
  theme_linedraw()
```


## 4.2) HALLMARK_HYPOXIA

We also must make HALLMARK_HYPOXIA, numeric

```{r}
r2_gse62564_GSVA_Metadata$HALLMARK_HYPOXIA <- as.numeric(r2_gse62564_GSVA_Metadata$HALLMARK_HYPOXIA)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=HALLMARK_HYPOXIA, fill=high_risk)) + 
    geom_boxplot()
```

## Include statistics analysis

In the next chunk, we construct a data-frame with statistics calculations for our plot.

The reference used here was the Kassambara 2023 article:

* [@Kassambara2023]

```{r}
library(rstatix)
# Statistical test
stat.test <- r2_gse62564_GSVA_Metadata %>%
  t_test(HALLMARK_HYPOXIA ~ high_risk) %>%
  add_significance()
stat.test
```

In the next chunk, we create the object that will show the statistical results. After, we use the stat_pvalue_manual function.

We also change the theme of the ggplot2 figure plot.

```{r}

library(ggpubr)

r2_gse62564_GSVA_Metadata$high_risk <- as.factor(r2_gse62564_GSVA_Metadata$high_risk)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=HALLMARK_HYPOXIA)) + 
    geom_boxplot()+
  stat_pvalue_manual(stat.test, label = "p", y.position = 0.6) + # y.position is mandatory
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.1)))

r2_gse62564_GSVA_Metadata$high_risk <- as.factor(r2_gse62564_GSVA_Metadata$high_risk)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=HALLMARK_HYPOXIA, fill="high_risk")) + 
    geom_boxplot()+
  stat_pvalue_manual(stat.test, label = "p", y.position = 0.6) + # y.position is mandatory
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.1)))

compare_means(data = r2_gse62564_GSVA_Metadata, HALLMARK_HYPOXIA ~ high_risk, method = "t.test")

ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=HALLMARK_HYPOXIA, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()

```

# ELVIDGE_HIF1A_TARGETS_UP

```{r}
r2_gse62564_GSVA_Metadata$ELVIDGE_HIF1A_TARGETS_UP <- as.numeric(r2_gse62564_GSVA_Metadata$ELVIDGE_HIF1A_TARGETS_UP)

compare_means(data = r2_gse62564_GSVA_Metadata, ELVIDGE_HIF1A_TARGETS_UP ~ high_risk, method = "t.test")

ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=ELVIDGE_HIF1A_TARGETS_UP, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

# GROSS_HYPOXIA_VIA_HIF1A_UP

```{r}
r2_gse62564_GSVA_Metadata$GROSS_HYPOXIA_VIA_HIF1A_UP <- as.numeric(r2_gse62564_GSVA_Metadata$GROSS_HYPOXIA_VIA_HIF1A_UP)

compare_means(data = r2_gse62564_GSVA_Metadata, GROSS_HYPOXIA_VIA_HIF1A_UP ~ high_risk, method = "t.test")

ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=GROSS_HYPOXIA_VIA_HIF1A_UP, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

# Hypoxia trial

```{r}
r2_gse62564_GSVA_Metadata$GROSS_HYPOXIA_VIA_HIF1A_DN <- as.numeric(r2_gse62564_GSVA_Metadata$GROSS_HYPOXIA_VIA_HIF1A_DN)

compare_means(data = r2_gse62564_GSVA_Metadata, GROSS_HYPOXIA_VIA_HIF1A_DN ~ high_risk, method = "t.test")

ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=GROSS_HYPOXIA_VIA_HIF1A_DN, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

## 4.3) Hypoxia Down-Regulation

## No statistical analysis

```{r}
r2_gse62564_GSVA_Metadata$ADRN_Norm_vs_Hypo_Down_635.txt <- as.numeric(r2_gse62564_GSVA_Metadata$ADRN_Norm_vs_Hypo_Down_635.txt)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=ADRN_Norm_vs_Hypo_Down_635.txt, fill=high_risk)) + 
    geom_boxplot()
```

## Statistical analysis

```{r}
compare_means(data = r2_gse62564_GSVA_Metadata, ADRN_Norm_vs_Hypo_Down_635.txt ~ high_risk, method = "t.test")

r2_gse62564_GSVA_Metadata$ADRN_Norm_vs_Hypo_Down_635.txt <- as.numeric(r2_gse62564_GSVA_Metadata$ADRN_Norm_vs_Hypo_Down_635.txt)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=ADRN_Norm_vs_Hypo_Down_635.txt, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

## 4.4) T cell exhaustion

Reference paper for the use of the T cell exhaustion gene set in this section was Chen 2020:

* [@Chen]

```{r}
r2_gse62564_GSVA_Metadata$`T cell exhaustion` <- as.numeric(r2_gse62564_GSVA_Metadata$`T cell exhaustion`)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=`T cell exhaustion`, fill=high_risk)) + 
    geom_boxplot()
```

## Statistical analysis

The compare_means function can not deal with spaces in the T cell exhaustion variable name.

We will have to use a trick to deal with the spaces in "T cell exhaustion".

We will use the package stringr to insert dots (.) replacing the spaces in the r2_gse62564_GSVA_Metadata dataframe.

To start, we have to create the r2_gse62564_GSVA_Metadata_Spaces dataframe, which will have structure names that contained spaces, changed to one of these new characteres: "." , ",", or "".

```{r}
r2_gse62564_GSVA_Metadata_Spaces <- r2_gse62564_GSVA_Metadata
library(stringr)
names(r2_gse62564_GSVA_Metadata_Spaces)<-str_replace_all(names(r2_gse62564_GSVA_Metadata_Spaces), c(" " = "." , "," = "" ))
```

Then, instead of using the r2_gse62564_GSVA_Metadata dataframe, we use r2_gse62564_GSVA_Metadata_Spaces. Note that now we will use the variable name as T.cell.exhaustion, without the spaces.

```{r}
compare_means(data = r2_gse62564_GSVA_Metadata_Spaces, T.cell.exhaustion ~ high_risk, method = "t.test")

r2_gse62564_GSVA_Metadata_Spaces$T.cell.exhaustion <- as.numeric(r2_gse62564_GSVA_Metadata_Spaces$T.cell.exhaustion)
ggplot(r2_gse62564_GSVA_Metadata_Spaces, aes(x=high_risk, y=T.cell.exhaustion, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

## 4.5) Quiescence

Hypoxia induces quiescence, the cell cycle arrest at the G0 phase [@Muz].

We found a quiescence signature on the work that discussed signatures of quiescent stem cells [@Cheung].

HIF1A activation in cancer cells augments T cell exhaustion and reduces T cell killing [@Baldominos].

In another example, we interrogate about the Quiescence gene signatures.

## 4.5.1) Quiescence Up-Regulated 

```{r}
r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Up.Cheung <- as.numeric(r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Up.Cheung)

compare_means(data = r2_gse62564_GSVA_Metadata_Spaces, Quiescence.Up.Cheung ~ high_risk, method = "t.test")

r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Up.Cheung <- as.numeric(r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Up.Cheung)
ggplot(r2_gse62564_GSVA_Metadata_Spaces, aes(x=high_risk, y=Quiescence.Up.Cheung, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

## 4.5.2) Quiescence Down-Regulated 

```{r}
r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Down.Cheung <- as.numeric(r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Down.Cheung)

compare_means(data = r2_gse62564_GSVA_Metadata_Spaces, Quiescence.Down.Cheung ~ high_risk, method = "t.test")

r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Down.Cheung <- as.numeric(r2_gse62564_GSVA_Metadata_Spaces$Quiescence.Down.Cheung)
ggplot(r2_gse62564_GSVA_Metadata_Spaces, aes(x=high_risk, y=Quiescence.Down.Cheung, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

## 4.6) HALLMARK_INFLAMMATORY_RESPONSE

## No statistical analysis

```{r}
r2_gse62564_GSVA_Metadata$HALLMARK_INFLAMMATORY_RESPONSE <- as.numeric(r2_gse62564_GSVA_Metadata$HALLMARK_INFLAMMATORY_RESPONSE)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=HALLMARK_INFLAMMATORY_RESPONSE, fill=high_risk)) + 
    geom_boxplot()
```

## Statistical analysis

```{r}
compare_means(data = r2_gse62564_GSVA_Metadata, HALLMARK_INFLAMMATORY_RESPONSE ~ high_risk, method = "t.test")

r2_gse62564_GSVA_Metadata$HALLMARK_INFLAMMATORY_RESPONSE <- as.numeric(r2_gse62564_GSVA_Metadata$HALLMARK_INFLAMMATORY_RESPONSE)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=HALLMARK_INFLAMMATORY_RESPONSE, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

## 4.7) ST8SIA1/GD2

## No Statistical Analysis

Reference paper for this section is Mabe 2022:

* [@Mabe]

```{r}
r2_gse62564_GSVA_Metadata$ST8SIA1 <- as.numeric(r2_gse62564_GSVA_Metadata$ST8SIA1)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=ST8SIA1, fill=high_risk)) + 
    geom_boxplot()
```

## Statistical analysis

```{r}
compare_means(data = r2_gse62564_GSVA_Metadata, ST8SIA1 ~ high_risk, method = "t.test")

r2_gse62564_GSVA_Metadata$ST8SIA1 <- as.numeric(r2_gse62564_GSVA_Metadata$ST8SIA1)
ggplot(r2_gse62564_GSVA_Metadata, aes(x=high_risk, y=ST8SIA1, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

# 5) Survival analysis of the hypoxia gene sets

## 5.1) HIF1A

## OS

```{r, warning=F, message=F}
library(tidyverse)

r2_gse62564_GSVA_Metadata_survival <- r2_gse62564_GSVA_Metadata %>%
    mutate(quantile = ntile(HIF1A, 2))

r2_gse62564_GSVA_Metadata_survival$quantile <- as.factor(r2_gse62564_GSVA_Metadata_survival$quantile )

qplot(HALLMARK_HYPOXIA, HIF1A, 
      data = r2_gse62564_GSVA_Metadata_survival,
      colour=quantile,
      ylab = "HIF1A",
      xlab = "Hallmark Hypoxia")

library(survival)
fit_os_HIF1A <- survfit(Surv(as.numeric(os_day), os_bin_numeric) ~ r2_gse62564_GSVA_Metadata_survival$quantile,
                   data = r2_gse62564_GSVA_Metadata_survival)
library(survminer)
ggsurvplot(fit_os_HIF1A, 
           data = r2_gse62564_GSVA_Metadata_survival, 
           risk.table = TRUE,
           # risk.table = "abs_pct",
           pval = TRUE, 
           pval.coord = c(4000, 1),
           )
```

## EFS

```{r, warning=F, message=F}
library(tidyverse)

r2_gse62564_GSVA_Metadata_survival <- r2_gse62564_GSVA_Metadata %>%
    mutate(quantile = ntile(HIF1A, 2))

library(survival)
fit_efs_HIF1A <- survfit(Surv(as.numeric(efs_day), efs_bin_numeric) ~ r2_gse62564_GSVA_Metadata_survival$quantile,
                   data = r2_gse62564_GSVA_Metadata_survival)
library(survminer)
ggsurvplot(fit_efs_HIF1A, 
           data = r2_gse62564_GSVA_Metadata_survival, 
           risk.table = TRUE,
           # risk.table = "abs_pct",
           pval = TRUE, 
           pval.coord = c(4000, 1),
           )
```

## 5.2) ELVIDGE_HIF1A_TARGETS_UP

```{r, warning=F, message=F}
library(tidyverse)

r2_gse62564_GSVA_Metadata_survival <- r2_gse62564_GSVA_Metadata %>%
    mutate(quantile = ntile(ELVIDGE_HIF1A_TARGETS_UP, 4))

library(survival)
fit_os_ELVIDGE_HIF1A_TARGETS_UP <- survfit(Surv(as.numeric(os_day), os_bin_numeric) ~ r2_gse62564_GSVA_Metadata_survival$quantile,
                   data = r2_gse62564_GSVA_Metadata_survival)
library(survminer)
ggsurvplot(fit_os_ELVIDGE_HIF1A_TARGETS_UP, 
           data = r2_gse62564_GSVA_Metadata_survival, 
           risk.table = TRUE,
           # risk.table = "abs_pct",
           pval = TRUE, 
           pval.coord = c(4000, 1),
           )
```

Another solution to this is using the ifelse statement to generate the gene set score as a categorical vector.

Once the categorical vector is generated, it can be used to be plotted in the Kaplan Meyer Survival curve.

## 5.3) T.cell.exhaustion (OS)

```{r}
library(tidyverse)

r2_gse62564_GSVA_Metadata_Spaces_survival <- r2_gse62564_GSVA_Metadata_Spaces %>%
    mutate(quantile = ntile(T.cell.exhaustion, 4))

library(survival)
fit_os_T.cell.exhaustion <- survfit(Surv(as.numeric(os_day), os_bin_numeric) ~ r2_gse62564_GSVA_Metadata_Spaces_survival$quantile,
                   data = r2_gse62564_GSVA_Metadata_Spaces_survival)
library(survminer)
ggsurvplot(fit_os_T.cell.exhaustion, 
           data = r2_gse62564_GSVA_Metadata_Spaces_survival, 
           risk.table = TRUE,
           # risk.table = "abs_pct",
           pval = TRUE, 
           pval.coord = c(4000, 1),
           )
```

## 5.4) T.cell.exhaustion (EFS)

```{r}
library(tidyverse)

r2_gse62564_GSVA_Metadata_Spaces_survival <- r2_gse62564_GSVA_Metadata_Spaces %>%
    mutate(quantile = ntile(T.cell.exhaustion, 2))

library(survival)
fit_efs_T.cell.exhaustion <- survfit(Surv(as.numeric(efs_day), efs_bin_numeric) ~ r2_gse62564_GSVA_Metadata_Spaces_survival$quantile,
                   data = r2_gse62564_GSVA_Metadata_Spaces_survival)
library(survminer)
ggsurvplot(fit_efs_T.cell.exhaustion, 
           data = r2_gse62564_GSVA_Metadata_Spaces_survival, 
           risk.table = TRUE,
           # risk.table = "abs_pct",
           pval = TRUE, 
           pval.coord = c(4000, 1),
           )
```

# 6) HIF1A relationship to age at diagnosis

## 6.1) HIF1A, age at diagnosis and HR

```{r}
r2_gse62564_GSVA_Metadata_Spaces_survival$age_at_diagnosis <- as.numeric(r2_gse62564_GSVA_Metadata_Spaces_survival$age_at_diagnosis)

max(r2_gse62564_GSVA_Metadata_Spaces_survival$age_at_diagnosis)
min(r2_gse62564_GSVA_Metadata_Spaces_survival$age_at_diagnosis)

r2_gse62564_GSVA_Metadata_Spaces_survival_age <- r2_gse62564_GSVA_Metadata_Spaces_survival %>%
    mutate(age_qtls = ntile(age_at_diagnosis, 4))

r2_gse62564_GSVA_Metadata_Spaces_survival_age$age_qtls <- as.factor(r2_gse62564_GSVA_Metadata_Spaces_survival_age$age_qtls)
ggplot(r2_gse62564_GSVA_Metadata_Spaces_survival_age, aes(x=age_qtls, y=HIF1A, fill=high_risk)) + 
    geom_boxplot()+
  stat_compare_means(method = "t.test")+
  theme_linedraw()
```

## 6.2) HIF1A, age at diagnosis and MYCN status

```{r}
r2_gse62564_GSVA_Metadata_Spaces_survival_age <- r2_gse62564_GSVA_Metadata_Spaces_survival %>%
    mutate(age_qtls = ntile(age_at_diagnosis, 4))

r2_gse62564_GSVA_Metadata_Spaces_survival_age$age_qtls <- as.factor(r2_gse62564_GSVA_Metadata_Spaces_survival_age$age_qtls)
ggplot(r2_gse62564_GSVA_Metadata_Spaces_survival_age, aes(x=age_qtls, y=HIF1A, fill=mycn_status)) + 
    geom_boxplot()+
  stat_compare_means(method = "anova")+
  theme_linedraw()
```

Remove the NAs from the mycn_status variable

```{r}
r2_gse62564_GSVA_Metadata_Spaces_survival_age <- r2_gse62564_GSVA_Metadata_Spaces_survival_age[which(
  r2_gse62564_GSVA_Metadata_Spaces_survival_age$mycn_status != "na"  ), ]

r2_gse62564_GSVA_Metadata_Spaces_survival_age <- r2_gse62564_GSVA_Metadata_Spaces_survival_age %>%
    mutate(age_qtls = ntile(age_at_diagnosis, 4))

r2_gse62564_GSVA_Metadata_Spaces_survival_age$age_qtls <- as.factor(r2_gse62564_GSVA_Metadata_Spaces_survival_age$age_qtls)
ggplot(r2_gse62564_GSVA_Metadata_Spaces_survival_age, aes(x=age_qtls, y=HIF1A, fill=mycn_status)) + 
    geom_boxplot()+
  stat_compare_means(method = "anova")+
  theme_linedraw()
```


# 7) References

<div id="refs"></div>

# 8) Session Info

```{r session}
sessionInfo()
```